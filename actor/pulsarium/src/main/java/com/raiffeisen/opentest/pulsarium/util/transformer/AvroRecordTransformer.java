package com.raiffeisen.opentest.pulsarium.util.transformer;

import lombok.AccessLevel;
import lombok.NoArgsConstructor;
import org.apache.pulsar.client.api.schema.GenericRecord;

import java.util.HashMap;
import java.util.Map;

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public class AvroRecordTransformer {
    
    public static Map<String, Object> toMap(GenericRecord record) {
        Map<String, Object> map = new HashMap<>();
        record.getFields().forEach(field ->
                map.put(field.getName(),
                        record.getField(field.getName())));
        return map;
    }
}
