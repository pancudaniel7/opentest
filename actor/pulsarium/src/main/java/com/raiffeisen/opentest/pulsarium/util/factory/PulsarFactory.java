package com.raiffeisen.opentest.pulsarium.util.factory;

import org.apache.pulsar.client.api.Schema;

import java.util.Map;

import static org.apache.pulsar.shade.org.eclipse.util.StringUtil.valueOf;

public abstract class PulsarFactory {

    protected static Schema getSchemaFrom(Map<String, Object> producerConfigMap) {
        String schemaType = valueOf(producerConfigMap.get("schemaType"));
        Map<String, Object> schemaMap = (Map<String, Object>) producerConfigMap.get("schema");

        return SchemaFactory.getSchema(schemaType, schemaMap);
    }

    protected static void removeCustomProperties(Map configMap) {
        configMap.remove("schemaType");
        configMap.remove("schema");
    }
}
