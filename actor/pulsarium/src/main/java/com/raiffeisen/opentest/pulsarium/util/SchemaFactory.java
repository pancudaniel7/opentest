package com.raiffeisen.opentest.pulsarium.util;

import lombok.AccessLevel;
import lombok.NoArgsConstructor;
import org.apache.pulsar.client.api.Schema;
import org.apache.pulsar.common.schema.SchemaType;

import java.util.Map;
import java.util.Objects;

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public class SchemaFactory {

    public static Schema create(Object schemaName) {
        return create(schemaName, null);
    }

    public static Schema create(Object schemaName, Map schemaFormat) {
        String schemaNameValue = Objects.toString(schemaName, "");

        switch (SchemaType.valueOf(schemaNameValue)) {
            case BYTES:
                return Schema.BYTES;
            case STRING:
                return Schema.STRING;
            case AVRO:
                return AvroSchemaBuilder.build(schemaNameValue, schemaFormat);
            default:
                throw new IllegalStateException("Unexpected value schema config value: " + schemaName);
        }
    }
}
