package com.raiffeisen.opentest.pulsarium.util.factory;

import com.raiffeisen.opentest.pulsarium.util.builder.AvroSchemaBuilder;
import lombok.AccessLevel;
import lombok.NoArgsConstructor;
import org.apache.pulsar.client.api.Schema;
import org.apache.pulsar.common.schema.SchemaType;

import java.util.Map;

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public class SchemaFactory {

    public static Schema getSchema(String schemaType, Map<String, Object> schemaMap) {

        SchemaType schemaTypeEnum = SchemaType.valueOf(schemaType);
        switch (schemaTypeEnum) {
            case BYTES:
                return Schema.BYTES;
            case STRING:
                return Schema.STRING;
            case AVRO:
                return AvroSchemaBuilder.build(schemaMap);
            default:
                throw new IllegalStateException("Unexpected schema config value: " + schemaType);
        }
    }
}
